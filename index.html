<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VALORANT Ïä§ÌÅ¨Î¶º Îß§Ïπ≠</title>
    <style>
:root {
    --val-red: #ff4655;
    --val-dark: #0f1923;
    --val-dark-2: #1c2633;
    --val-dark-3: #2a3443;
    --val-gold: #f1c40f;
    --val-success: #27ae60;
    --val-text: #ece8e1;
    --val-text-muted: #8a9099;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, var(--val-dark) 0%, #0d1117 100%);
    color: var(--val-text);
    min-height: 100vh;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 30px;
    background: var(--val-dark-2);
    border-radius: 12px;
    margin-bottom: 30px;
    border: 1px solid rgba(255, 70, 85, 0.2);
}

.logo h1 {
    color: var(--val-red);
    font-size: 2.2rem;
    font-weight: 800;
    letter-spacing: 2px;
    text-transform: uppercase;
}

.tagline {
    color: var(--val-text-muted);
    font-size: 0.9rem;
    margin-top: 5px;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.user-name {
    font-weight: 600;
    color: var(--val-text);
}

.btn {
    padding: 10px 24px;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.95rem;
}

.btn-primary {
    background: var(--val-red);
    color: white;
}

.btn-primary:hover {
    background: #e63946;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 70, 85, 0.4);
}

.btn-secondary {
    background: var(--val-dark-3);
    color: var(--val-text);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.btn-secondary:hover {
    background: var(--val-dark-2);
    border-color: var(--val-red);
}

.btn-large {
    padding: 14px 32px;
    font-size: 1rem;
    width: 100%;
    margin-top: 20px;
}

.btn-success {
    background: var(--val-success);
    color: white;
}

.btn-success:hover {
    background: #229954;
}

.nav {
    display: flex;
    gap: 10px;
    margin-bottom: 30px;
    background: var(--val-dark-2);
    padding: 10px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.nav-btn {
    flex: 1;
    padding: 14px 20px;
    background: transparent;
    border: none;
    color: var(--val-text-muted);
    font-weight: 600;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.nav-btn:hover {
    background: var(--val-dark-3);
    color: var(--val-text);
}

.nav-btn.active {
    background: var(--val-red);
    color: white;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.filters {
    background: var(--val-dark-2);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.filters h2 {
    color: var(--val-red);
    margin-bottom: 15px;
}

.filter-group {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-wrap: wrap;
}

.filter-group label {
    font-weight: 600;
    color: var(--val-text-muted);
}

.filter-group select {
    padding: 8px 12px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    color: var(--val-text);
    font-size: 0.95rem;
}

.scrim-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 20px;
}

.scrim-card {
    background: var(--val-dark-2);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s ease;
    cursor: pointer;
}

.scrim-card:hover {
    transform: translateY(-4px);
    border-color: var(--val-red);
    box-shadow: 0 8px 24px rgba(255, 70, 85, 0.2);
}

.scrim-card.matched {
    border-color: var(--val-success);
    opacity: 0.7;
}

.scrim-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.team-name {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--val-text);
}

.status-badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
}

.status-badge.open {
    background: rgba(46, 204, 113, 0.2);
    color: #2ecc71;
}

.status-badge.matched {
    background: rgba(241, 196, 15, 0.2);
    color: var(--val-gold);
}

.scrim-info {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.info-row {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--val-text-muted);
    font-size: 0.9rem;
}

.info-label {
    font-weight: 600;
}

.rank-badge {
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: 600;
    display: inline-block;
}

.rank-iron { background: #4a4a4a; }
.rank-bronze { background: #cd7f32; }
.rank-silver { background: #c0c0c0; }
.rank-gold { background: #ffd700; color: #333; }
.rank-platinum { background: #00d4aa; }
.rank-diamond { background: #b9f2ff; color: #333; }
.rank-ascendant { background: #9d4dbb; }
.rank-immortal { background: #ff4655; }
.rank-radiant { background: #ffeb3b; color: #333; }

.create-form, .team-section {
    background: var(--val-dark-2);
    padding: 30px;
    border-radius: 12px;
    max-width: 600px;
    margin: 0 auto;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.create-form h2, .team-section h2 {
    color: var(--val-red);
    margin-bottom: 25px;
    font-size: 1.8rem;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--val-text-muted);
}

.form-group input,
.form-group select {
    width: 100%;
    padding: 12px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    color: var(--val-text);
    font-size: 0.95rem;
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: var(--val-red);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.team-card {
    background: var(--val-dark-3);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.team-card h3 {
    color: var(--val-red);
    font-size: 1.5rem;
    margin-bottom: 15px;
}

.team-stats {
    display: flex;
    gap: 30px;
    margin-top: 15px;
}

.stat {
    display: flex;
    flex-direction: column;
}

.stat-label {
    color: var(--val-text-muted);
    font-size: 0.85rem;
    margin-bottom: 5px;
}

.stat-value {
    color: var(--val-text);
    font-size: 1.2rem;
    font-weight: 700;
}

.no-team {
    text-align: center;
    padding: 40px;
}

.no-team p {
    color: var(--val-text-muted);
    margin-bottom: 20px;
    font-size: 1.1rem;
}

.history-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.history-item {
    background: var(--val-dark-2);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.history-teams {
    display: flex;
    align-items: center;
    gap: 20px;
}

.vs {
    color: var(--val-red);
    font-weight: 700;
    font-size: 1.2rem;
}

.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(4px);
}

.modal.active {
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background: var(--val-dark-2);
    padding: 30px;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    position: relative;
    border: 1px solid rgba(255, 70, 85, 0.3);
    animation: modalSlide 0.3s ease;
}

@keyframes modalSlide {
    from {
        transform: translateY(-50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.modal-content h2 {
    color: var(--val-red);
    margin-bottom: 20px;
}

.close {
    position: absolute;
    right: 15px;
    top: 15px;
    font-size: 28px;
    font-weight: bold;
    color: var(--val-text-muted);
    cursor: pointer;
    transition: color 0.3s ease;
}

.close:hover {
    color: var(--val-red);
}

@media (max-width: 768px) {
    .header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }

    .nav {
        flex-direction: column;
    }

    .scrim-list {
        grid-template-columns: 1fr;
    }

    .form-row {
        grid-template-columns: 1fr;
    }

    .filter-group {
        flex-direction: column;
        align-items: stretch;
    }
    
    .logo h1 {
        font-size: 1.5rem;
    }
}

.loading {
    text-align: center;
    padding: 40px;
    color: var(--val-text-muted);
}

.loading::after {
    content: '...';
    animation: dots 1.5s infinite;
}

@keyframes dots {
    0%, 20% { content: '.'; }
    40% { content: '..'; }
    60%, 100% { content: '...'; }
}





/* ===== Í≤ÄÏÉâ & Í≥†Í∏â ÌïÑÌÑ∞ ===== */
.search-filter-bar {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    align-items: center;
}

.search-input {
    flex: 1;
    padding: 12px 15px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    color: var(--val-text);
    font-size: 0.9rem;
}

.search-input::placeholder {
    color: var(--val-text-muted);
}

.search-input:focus {
    outline: none;
    border-color: var(--val-red);
}

.filter-settings-btn {
    width: 44px;
    height: 44px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    position: relative;
}

.filter-settings-btn:hover {
    background: var(--val-dark-2);
    border-color: var(--val-red);
}

.filter-settings-btn.active {
    background: var(--val-red);
    border-color: var(--val-red);
}

.filter-settings-btn svg {
    width: 20px;
    height: 20px;
    fill: var(--val-text);
}

.filter-settings-btn.active svg {
    fill: white;
    animation: rotate 0.5s ease;
}

@keyframes rotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(180deg); }
}

/* Í≥†Í∏â ÌïÑÌÑ∞ Ìå®ÎÑê */
.advanced-filter-panel {
    background: var(--val-dark-2);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    display: none;
    animation: slideDown 0.3s ease;
    position: relative;
    z-index: 500;
}

.advanced-filter-panel.show {
    display: block;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.filter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.filter-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
    position: relative;
    z-index: 100;
}

.filter-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--val-text);
}

.filter-select {
    padding: 10px 12px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    color: var(--val-text);
    font-size: 0.85rem;
    cursor: pointer;
}

.filter-select:focus {
    outline: none;
    border-color: var(--val-red);
}

.filter-checkbox-group {
    display: flex;
    gap: 15px;
}

.filter-checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.filter-checkbox input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--val-red);
}

.filter-checkbox label {
    font-size: 0.85rem;
    color: var(--val-text);
    cursor: pointer;
}

.filter-actions {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid rgba(255,255,255,0.05);
}

.btn-filter-apply {
    flex: 1;
    padding: 10px;
    background: var(--val-red);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.2s;
}

.btn-filter-apply:hover {
    background: #cc2233;
}

.btn-filter-reset {
    padding: 10px 20px;
    background: var(--val-dark-3);
    color: var(--val-text-muted);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-filter-reset:hover {
    background: var(--val-dark-2);
    color: var(--val-text);
}

/* ===== Îû≠ÌÅ¨ ÌïÑÌÑ∞ ÎìúÎ°≠Îã§Ïö¥ ===== */
.rank-filter-wrapper {
    position: relative;
    min-width: 180px;
    z-index: 100;
}

.rank-select-display {
    padding: 8px 35px 8px 12px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    color: var(--val-text);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
    user-select: none;
}

.rank-select-display::after {
    content: '‚ñº';
    position: absolute;
    right: 12px;
    font-size: 0.7rem;
    color: var(--val-text-muted);
}

.rank-select-display img {
    width: 20px;
    height: 20px;
}

.rank-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--val-dark-2);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    margin-top: 4px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 2000;
    display: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
}

.rank-dropdown.show {
    display: block;
}

.rank-option {
    padding: 10px 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: background 0.2s;
}

.rank-option:hover {
    background: var(--val-dark-3);
}

.rank-option img {
    width: 24px;
    height: 24px;
}

.rank-option.selected {
    background: rgba(255, 70, 85, 0.2);
}

/* ===== ÎùºÏù¥Ïóá Ìã∞Ïñ¥ Ïù∏Ï¶ù ===== */
.riot-verify-section {
    width: 100%;
    margin-top: 10px;
}

.riot-input-row {
    display: flex;
    gap: 6px;
    margin-bottom: 8px;
}

.riot-input-row input {
    flex: 1;
    padding: 7px 10px;
    background: var(--val-dark-3);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 8px;
    color: var(--val-text);
    font-size: 0.8rem;
    min-width: 0;
}

.riot-input-row input::placeholder {
    color: var(--val-text-muted);
    font-size: 0.75rem;
}

.riot-input-row input:focus {
    outline: none;
    border-color: var(--val-red);
}

.btn-verify {
    padding: 7px 12px;
    background: var(--val-red);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 700;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s;
}

.btn-verify:hover { background: #cc2233; }
.btn-verify:disabled { background: #555; cursor: not-allowed; }

.tier-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--val-dark-3);
    border-radius: 8px;
    padding: 8px 12px;
    margin-top: 6px;
    border: 1px solid rgba(255,255,255,0.08);
}

.tier-badge img {
    width: 32px;
    height: 32px;
}

.tier-info {
    display: flex;
    flex-direction: column;
}

.tier-name {
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--val-text);
}

.tier-rr {
    font-size: 0.7rem;
    color: var(--val-text-muted);
}

.verify-status {
    font-size: 0.75rem;
    text-align: center;
    padding: 4px;
    border-radius: 6px;
    margin-top: 4px;
}

.verify-status.loading { color: #aaa; }
.verify-status.success { color: #4ade80; }
.verify-status.error { color: var(--val-red); }

/* ===== ÎãàÌä∏Î°ú & Î±ÉÏßÄ ===== */
.profile-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: center;
    margin-bottom: 12px;
}

.badge {
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 4px;
}

.badge-nitro {
    background: linear-gradient(135deg, #8b5cf6, #6366f1);
    color: white;
    box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4);
    animation: nitroPulse 2s infinite;
}

.badge-nitro-classic {
    background: linear-gradient(135deg, #6366f1, #4f46e5);
    color: white;
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
}

.badge-staff {
    background: linear-gradient(135deg, #ff4655, #cc2233);
    color: white;
}

.badge-partner {
    background: linear-gradient(135deg, #5865f2, #4752c4);
    color: white;
}

.badge-hypesquad {
    background: linear-gradient(135deg, #f1c40f, #e67e22);
    color: white;
}

.badge-bughunter {
    background: linear-gradient(135deg, #27ae60, #1e8449);
    color: white;
}

.badge-early {
    background: linear-gradient(135deg, #8b5cf6, #ec4899);
    color: white;
}

.badge-active {
    background: linear-gradient(135deg, #27ae60, #00d4aa);
    color: white;
}

.badge-boost {
    background: linear-gradient(135deg, #ff73fa, #c061f7);
    color: white;
    box-shadow: 0 2px 8px rgba(255, 115, 250, 0.4);
}

@keyframes nitroPulse {
    0%, 100% { box-shadow: 0 2px 8px rgba(139, 92, 246, 0.4); }
    50% { box-shadow: 0 2px 16px rgba(139, 92, 246, 0.8); }
}

/* ÎãàÌä∏Î°ú ÏïÑÎ∞îÌÉÄ ÌÖåÎëêÎ¶¨ */
.avatar-nitro {
    border: 3px solid transparent !important;
    background: linear-gradient(var(--val-dark-2), var(--val-dark-2)) padding-box,
                linear-gradient(135deg, #8b5cf6, #6366f1, #ec4899) border-box !important;
    animation: nitroBorder 3s linear infinite;
}

@keyframes nitroBorder {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
}

/* ÎãàÌä∏Î°ú ÌîÑÎ°úÌïÑ Î∞∞ÎÑà */
.profile-banner {
    height: 60px;
    border-radius: 8px 8px 0 0;
    margin: -20px -20px 15px -20px;
    background: var(--val-dark-3);
}

.profile-banner.nitro-banner {
    background: linear-gradient(135deg, #8b5cf6, #6366f1, #ec4899);
    animation: bannerShift 4s ease infinite;
}

@keyframes bannerShift {
    0%, 100% { filter: hue-rotate(0deg) brightness(1); }
    50% { filter: hue-rotate(30deg) brightness(1.2); }
}

/* ===== ÏÇ¨Ïù¥ÎìúÎ∞î ÌîÑÎ°úÌïÑ ===== */
.app-layout {
    display: flex;
    gap: 20px;
}

.sidebar {
    width: 260px;
    min-width: 260px;
    display: none;
    flex-direction: column;
    gap: 15px;
}

.sidebar.visible {
    display: flex;
}

.main-area {
    flex: 1;
    min-width: 0;
}

.profile-card {
    background: var(--val-dark-2);
    border-radius: 12px;
    padding: 20px;
    border: 1px solid rgba(255, 70, 85, 0.2);
    text-align: center;
}

.profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid var(--val-red);
    margin: 0 auto 12px;
    display: block;
    object-fit: cover;
    position: relative;
}

.profile-avatar-placeholder {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid var(--val-red);
    margin: 0 auto 12px;
    background: var(--val-dark-3);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    position: relative;
}

#avatarWrapper {
    position: relative;
    display: inline-block;
    width: 80px;
    height: 80px;
    margin: 0 auto 12px;
}

#avatarWrapper .profile-avatar,
#avatarWrapper .profile-avatar-placeholder {
    margin: 0;
    width: 80px;
    height: 80px;
}

.profile-name {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--val-text);
    margin-bottom: 4px;
}

.profile-tag {
    font-size: 0.8rem;
    color: var(--val-text-muted);
    margin-bottom: 15px;
}

.profile-stats {
    display: flex;
    justify-content: space-around;
    padding: 12px 0;
    border-top: 1px solid rgba(255,255,255,0.05);
    border-bottom: 1px solid rgba(255,255,255,0.05);
    margin-bottom: 15px;
}

.stat-item {
    text-align: center;
}

.stat-number {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--val-red);
}

.stat-label {
    font-size: 0.75rem;
    color: var(--val-text-muted);
}

.profile-team {
    background: var(--val-dark-3);
    border-radius: 8px;
    padding: 10px;
    font-size: 0.85rem;
    color: var(--val-text-muted);
}

.profile-team span {
    color: var(--val-text);
    font-weight: 600;
}

.sidebar-logout {
    width: 100%;
    margin-top: 10px;
    background: var(--val-red) !important;
    color: white !important;
    border: none !important;
}

/* ===== ÌôòÏòÅ Ïï†ÎãàÎ©îÏù¥ÏÖò ===== */
.welcome-overlay {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    justify-content: center;
    align-items: center;
    flex-direction: column;
    pointer-events: none;
}

.welcome-overlay.show {
    display: flex;
    animation: fadeIn 0.3s ease;
    pointer-events: all;
}

.welcome-content {
    text-align: center;
    animation: welcomeZoom 0.5s ease;
}

#welcomeAvatarWrapper {
    position: relative;
    width: 100px;
    height: 100px;
    margin: 0 auto 20px;
    display: block;
}

.welcome-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 4px solid var(--val-red);
    margin: 0;
    display: block;
    animation: avatarPulse 0.8s ease;
    position: relative;
    z-index: 1;
}

.welcome-avatar-placeholder {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 4px solid var(--val-red);
    margin: 0;
    background: var(--val-dark-3);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    animation: avatarPulse 0.8s ease;
    position: relative;
    z-index: 1;
}

#welcomeDecoration {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 130px !important;
    height: 130px !important;
    z-index: 2 !important;
    pointer-events: none;
}

.welcome-title {
    font-size: 1.2rem;
    color: var(--val-text-muted);
    margin-bottom: 8px;
}

.welcome-name {
    font-size: 2rem;
    font-weight: 800;
    color: var(--val-red);
    letter-spacing: 2px;
    margin-bottom: 10px;
}

.welcome-subtitle {
    font-size: 1rem;
    color: var(--val-text-muted);
    margin-bottom: 30px;
}

.welcome-bar {
    width: 200px;
    height: 4px;
    background: var(--val-dark-3);
    border-radius: 2px;
    margin: 0 auto;
    overflow: hidden;
}

.welcome-bar-fill {
    height: 100%;
    background: var(--val-red);
    border-radius: 2px;
    animation: barFill 1.5s ease forwards;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes welcomeZoom {
    from { transform: scale(0.7); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

@keyframes avatarPulse {
    0% { transform: scale(0); }
    60% { transform: scale(1.15); }
    100% { transform: scale(1); }
}

@keyframes barFill {
    from { width: 0%; }
    to { width: 100%; }
}

/* Î°úÍ∑∏ÏïÑÏõÉ ÌôïÏù∏ ÌåùÏóÖ */
.logout-confirm {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    pointer-events: none;
}

.logout-confirm.show {
    display: flex;
    pointer-events: all;
}

.logout-box {
    background: var(--val-dark-2);
    border: 1px solid rgba(255,70,85,0.3);
    border-radius: 12px;
    padding: 30px;
    text-align: center;
    width: 300px;
}

.logout-box h3 {
    color: var(--val-red);
    margin-bottom: 10px;
    font-size: 1.3rem;
}

.logout-box p {
    color: var(--val-text-muted);
    margin-bottom: 20px;
}

.logout-btns {
    display: flex;
    gap: 10px;
    justify-content: center;
}

@media (max-width: 768px) {
    .app-layout {
        flex-direction: column;
    }
    .sidebar {
        width: 100%;
        min-width: unset;
    }
    .profile-stats {
        gap: 10px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <h1>VALORANT SCRIMS</h1>
                <p class="tagline">ÌåÄ Ïä§ÌÅ¨Î¶º Îß§Ïπ≠ ÌîåÎû´Ìèº</p>
            </div>
            <div class="user-info" id="userInfo">
                <button class="btn btn-primary" id="loginBtn">Discord Î°úÍ∑∏Ïù∏</button>
            </div>
        </header>

        <nav class="nav">
            <button class="nav-btn active" data-tab="scrims">Ïä§ÌÅ¨Î¶º Ï∞æÍ∏∞</button>
            <button class="nav-btn" data-tab="myteam">ÎÇ¥ ÌåÄ</button>
            <button class="nav-btn" data-tab="create">Ïä§ÌÅ¨Î¶º Îì±Î°ù</button>
            <button class="nav-btn" data-tab="history">Îß§Ïπ≠ ÎÇ¥Ïó≠</button>
        </nav>

        <div class="app-layout">
            <!-- ÏÇ¨Ïù¥ÎìúÎ∞î ÌîÑÎ°úÌïÑ -->
            <aside class="sidebar" id="sidebar">
                <div class="profile-card" id="profileCard">
                    <div class="profile-banner" id="profileBanner"></div>
                    <div class="profile-avatar-placeholder" id="profileAvatarPlaceholder">üë§</div>
                    <img class="profile-avatar" id="profileAvatar" style="display:none;" src="" alt="avatar">
                    <div class="profile-name" id="profileName">-</div>
                    <div class="profile-tag" id="profileTag">Discord Ïó∞Îèô</div>
                    <div class="profile-badges" id="profileBadges"></div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-number" id="statScrims">0</div>
                            <div class="stat-label">Ïä§ÌÅ¨Î¶º</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="statMatches">0</div>
                            <div class="stat-label">Îß§Ïπ≠</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-number" id="statNoShow">0</div>
                            <div class="stat-label">ÎÖ∏Ïáº</div>
                        </div>
                    </div>
                    <div class="profile-team" id="profileTeam">ÌåÄ: <span>ÏóÜÏùå</span></div>
                    
                    <!-- ÎùºÏù¥Ïóá Ìã∞Ïñ¥ Ïù∏Ï¶ù -->
                    <div class="riot-verify-section" id="riotVerifySection">
                        <div id="riotTierDisplay" style="display:none;">
                            <div class="tier-badge" id="tierBadge">
                                <img id="tierIcon" src="" alt="tier">
                                <div class="tier-info">
                                    <div class="tier-name" id="tierName">-</div>
                                    <div class="tier-rr" id="tierRR">-</div>
                                </div>
                                <span style="margin-left:auto; font-size:0.7rem; color:#4ade80;">‚úÖ Ïù∏Ï¶ùÎê®</span>
                                <button onclick="resetRiotVerify()" style="background:none;border:none;color:#aaa;cursor:pointer;font-size:0.8rem;">‚úï</button>
                            </div>
                        </div>
                        <div id="riotInputSection">
                            <div class="riot-input-row">
                                <input type="text" id="riotName" placeholder="ÎãâÎÑ§ÏûÑ" />
                                <input type="text" id="riotTag" placeholder="#KR1" style="width:70px;flex:none;" />
                                <button class="btn-verify" id="verifyBtn" onclick="verifyRiotAccount()">Ïù∏Ï¶ù</button>
                            </div>
                            <div class="verify-status" id="verifyStatus"></div>
                        </div>
                    </div>

                    <button class="btn btn-secondary sidebar-logout" onclick="showLogoutConfirm()">Î°úÍ∑∏ÏïÑÏõÉ</button>
                </div>
            </aside>

        <main class="main-content main-area">
            <div class="tab-content active" id="scrims">
                <div class="filters">
                    <h2>Ïä§ÌÅ¨Î¶º Î™©Î°ù</h2>
                    
                    <!-- Í≤ÄÏÉâ & Í≥†Í∏â ÌïÑÌÑ∞ -->
                    <div class="search-filter-bar">
                        <input type="text" class="search-input" id="searchInput" placeholder="üîç ÌåÄÎ™Ö, ÏÑ§Î™Ö Í≤ÄÏÉâ..." onkeyup="applyAllFilters()">
                        <button class="filter-settings-btn" id="filterSettingsBtn" onclick="toggleAdvancedFilter()">
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/>
                            </svg>
                        </button>
                    </div>

                    <!-- Í≥†Í∏â ÌïÑÌÑ∞ Ìå®ÎÑê -->
                    <div class="advanced-filter-panel" id="advancedFilterPanel">
                        <div class="filter-grid">
                            <div class="filter-item">
                                <label class="filter-label">Ìã∞Ïñ¥</label>
                                <div class="rank-filter-wrapper" style="min-width:auto;">
                                    <div class="rank-select-display" id="advTierDisplay" onclick="toggleAdvTierDropdown()">
                                        <span id="advTierDisplayText">Ï†ÑÏ≤¥</span>
                                    </div>
                                    <div class="rank-dropdown" id="advTierDropdown">
                                        <div class="rank-option" data-value="" onclick="selectAdvTier('', 'Ï†ÑÏ≤¥', null)">
                                            <span>Ï†ÑÏ≤¥</span>
                                        </div>
                                        <div class="rank-option" data-value="6-1" onclick="selectAdvTier('6-1', 'Diamond I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/18.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/18.png" alt="Diamond">
                                            <span>Diamond I</span>
                                        </div>
                                        <div class="rank-option" data-value="6-2" onclick="selectAdvTier('6-2', 'Diamond II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/19.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/19.png" alt="Diamond">
                                            <span>Diamond II</span>
                                        </div>
                                        <div class="rank-option" data-value="6-3" onclick="selectAdvTier('6-3', 'Diamond III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/20.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/20.png" alt="Diamond">
                                            <span>Diamond III</span>
                                        </div>
                                        <div class="rank-option" data-value="7-1" onclick="selectAdvTier('7-1', 'Ascendant I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/21.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/21.png" alt="Ascendant">
                                            <span>Ascendant I</span>
                                        </div>
                                        <div class="rank-option" data-value="7-2" onclick="selectAdvTier('7-2', 'Ascendant II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/22.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/22.png" alt="Ascendant">
                                            <span>Ascendant II</span>
                                        </div>
                                        <div class="rank-option" data-value="7-3" onclick="selectAdvTier('7-3', 'Ascendant III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/23.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/23.png" alt="Ascendant">
                                            <span>Ascendant III</span>
                                        </div>
                                        <div class="rank-option" data-value="8-1" onclick="selectAdvTier('8-1', 'Immortal I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/24.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/24.png" alt="Immortal">
                                            <span>Immortal I</span>
                                        </div>
                                        <div class="rank-option" data-value="8-2" onclick="selectAdvTier('8-2', 'Immortal II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/25.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/25.png" alt="Immortal">
                                            <span>Immortal II</span>
                                        </div>
                                        <div class="rank-option" data-value="8-3" onclick="selectAdvTier('8-3', 'Immortal III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/26.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/26.png" alt="Immortal">
                                            <span>Immortal III</span>
                                        </div>
                                        <div class="rank-option" data-value="9" onclick="selectAdvTier('9', 'Radiant', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/27.png')">
                                            <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/27.png" alt="Radiant">
                                            <span>Radiant</span>
                                        </div>
                                    </div>
                                    <input type="hidden" id="advTierFilter" value="">
                                </div>
                            </div>
                            <div class="filter-item">
                                <label class="filter-label">ÏãúÍ∞Ñ</label>
                                <select class="filter-select" id="advTimeFilter">
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    <option value="morning">Ïò§Ï†Ñ (06:00-12:00)</option>
                                    <option value="afternoon">Ïò§ÌõÑ (12:00-18:00)</option>
                                    <option value="evening">Ï†ÄÎÖÅ (18:00-24:00)</option>
                                    <option value="night">Ïã¨Ïïº (00:00-06:00)</option>
                                </select>
                            </div>
                            <div class="filter-item">
                                <label class="filter-label">ÏÑúÎ≤Ñ</label>
                                <select class="filter-select" id="advServerFilter">
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    <option value="kr">KR</option>
                                    <option value="jp">JP</option>
                                </select>
                            </div>
                            <div class="filter-item">
                                <label class="filter-label">Îßµ</label>
                                <select class="filter-select" id="advMapFilter">
                                    <option value="">Ï†ÑÏ≤¥</option>
                                    <option value="Ascent">Ascent</option>
                                    <option value="Bind">Bind</option>
                                    <option value="Haven">Haven</option>
                                    <option value="Split">Split</option>
                                    <option value="Icebox">Icebox</option>
                                    <option value="Breeze">Breeze</option>
                                    <option value="Fracture">Fracture</option>
                                    <option value="Pearl">Pearl</option>
                                    <option value="Lotus">Lotus</option>
                                    <option value="Sunset">Sunset</option>
                                    <option value="Abyss">Abyss</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-checkbox-group" style="margin-top: 15px;">
                            <div class="filter-checkbox">
                                <input type="checkbox" id="advGcFilter">
                                <label for="advGcFilter">GC ÏÑ†ÌÉùÍ∞ÄÎä•Îßå</label>
                            </div>
                            <div class="filter-checkbox">
                                <input type="checkbox" id="advCoachFilter">
                                <label for="advCoachFilter">ÏΩîÏπò ÏûàÏùåÎßå</label>
                            </div>
                        </div>
                        <div class="filter-actions">
                            <button class="btn-filter-apply" onclick="applyAllFilters()">ÌïÑÌÑ∞ Ï†ÅÏö©</button>
                            <button class="btn-filter-reset" onclick="resetAdvancedFilters()">Ï¥àÍ∏∞Ìôî</button>
                        </div>
                    </div>
                    <div class="filter-group">
                        <label>Îû≠ÌÅ¨ ÌïÑÌÑ∞:</label>
                        <div class="rank-filter-wrapper">
                            <div class="rank-select-display" id="rankSelectDisplay" onclick="toggleRankDropdown()">
                                <span id="rankDisplayText">Ï†ÑÏ≤¥</span>
                            </div>
                            <div class="rank-dropdown" id="rankDropdown">
                                <div class="rank-option" data-value="" onclick="selectRank('', 'Ï†ÑÏ≤¥', null)">
                                    <span>Ï†ÑÏ≤¥</span>
                                </div>
                                <div class="rank-option" data-value="6-1" onclick="selectRank('6-1', 'Diamond I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/18.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/18.png" alt="Diamond">
                                    <span>Diamond I</span>
                                </div>
                                <div class="rank-option" data-value="6-2" onclick="selectRank('6-2', 'Diamond II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/19.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/19.png" alt="Diamond">
                                    <span>Diamond II</span>
                                </div>
                                <div class="rank-option" data-value="6-3" onclick="selectRank('6-3', 'Diamond III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/20.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/20.png" alt="Diamond">
                                    <span>Diamond III</span>
                                </div>
                                <div class="rank-option" data-value="7-1" onclick="selectRank('7-1', 'Ascendant I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/21.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/21.png" alt="Ascendant">
                                    <span>Ascendant I</span>
                                </div>
                                <div class="rank-option" data-value="7-2" onclick="selectRank('7-2', 'Ascendant II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/22.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/22.png" alt="Ascendant">
                                    <span>Ascendant II</span>
                                </div>
                                <div class="rank-option" data-value="7-3" onclick="selectRank('7-3', 'Ascendant III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/23.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/23.png" alt="Ascendant">
                                    <span>Ascendant III</span>
                                </div>
                                <div class="rank-option" data-value="8-1" onclick="selectRank('8-1', 'Immortal I', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/24.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/24.png" alt="Immortal">
                                    <span>Immortal I</span>
                                </div>
                                <div class="rank-option" data-value="8-2" onclick="selectRank('8-2', 'Immortal II', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/25.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/25.png" alt="Immortal">
                                    <span>Immortal II</span>
                                </div>
                                <div class="rank-option" data-value="8-3" onclick="selectRank('8-3', 'Immortal III', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/26.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/26.png" alt="Immortal">
                                    <span>Immortal III</span>
                                </div>
                                <div class="rank-option" data-value="9" onclick="selectRank('9', 'Radiant', 'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/27.png')">
                                    <img src="https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/27.png" alt="Radiant">
                                    <span>Radiant</span>
                                </div>
                            </div>
                            <input type="hidden" id="rankFilter" value="">
                        </div>
                        <button class="btn btn-secondary" id="refreshBtn">ÏÉàÎ°úÍ≥†Ïπ®</button>
                    </div>
                </div>
                
                <div class="scrim-list" id="scrimList"></div>
            </div>

            <div class="tab-content" id="myteam">
                <div class="team-section">
                    <h2>ÌåÄ Í¥ÄÎ¶¨</h2>
                    <div id="teamInfo">
                        <div class="no-team">
                            <p>ÏïÑÏßÅ ÌåÄÏù¥ ÏóÜÏäµÎãàÎã§.</p>
                            <button class="btn btn-primary" id="createTeamBtn">ÌåÄ ÏÉùÏÑ±ÌïòÍ∏∞</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="create">
                <div class="create-form">
                    <h2>Ïä§ÌÅ¨Î¶º Îì±Î°ù</h2>
                    <form id="createScrimForm">
                        <div class="form-group">
                            <label>ÎÇ†Ïßú Î∞è ÏãúÍ∞Ñ</label>
                            <input type="datetime-local" id="scrimDate" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÏµúÏÜå Îû≠ÌÅ¨</label>
                                <select id="minRank" required>
                                    <option value="6-1" selected>Diamond I</option>
                                    <option value="6-1">Diamond I</option>
                                    <option value="6-2">Diamond II</option>
                                    <option value="6-3">Diamond III</option>
                                    <option value="7-1">Ascendant I</option>
                                    <option value="7-2">Ascendant II</option>
                                    <option value="7-3">Ascendant III</option>
                                    <option value="8-1">Immortal I</option>
                                    <option value="8-2">Immortal II</option>
                                    <option value="8-3">Immortal III</option>
                                    <option value="9">Radiant</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label>ÏµúÎåÄ Îû≠ÌÅ¨</label>
                                <select id="maxRank" required>
                                    <option value="6-1">Diamond I</option>
                                    <option value="6-2">Diamond II</option>
                                    <option value="6-3">Diamond III</option>
                                    <option value="7-1">Ascendant I</option>
                                    <option value="7-2">Ascendant II</option>
                                    <option value="7-3">Ascendant III</option>
                                    <option value="8-1">Immortal I</option>
                                    <option value="8-2">Immortal II</option>
                                    <option value="8-3">Immortal III</option>
                                    <option value="9">Radiant</option>
                                </select>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-large">Ïä§ÌÅ¨Î¶º Îì±Î°ù</button>
                    </form>
                </div>
            </div>

            <div class="tab-content" id="history">
                <h2 style="color: var(--val-red); margin-bottom: 20px;">Îß§Ïπ≠ ÎÇ¥Ïó≠</h2>
                <div class="history-list" id="historyList"></div>
            </div>
        </main>
        </div><!-- app-layout -->

        <div class="modal" id="teamModal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>ÌåÄ ÏÉùÏÑ±</h2>
                <form id="teamForm">
                    <div class="form-group">
                        <label>ÌåÄ Ïù¥Î¶Ñ</label>
                        <input type="text" id="teamName" required>
                    </div>
                    <div class="form-group">
                        <label>ÌèâÍ∑† Îû≠ÌÅ¨</label>
                        <select id="teamRank" required>
                            <option value="6-1">Diamond I</option>
                            <option value="6-2">Diamond II</option>
                            <option value="6-3">Diamond III</option>
                            <option value="7-1">Ascendant I</option>
                            <option value="7-2">Ascendant II</option>
                            <option value="7-3">Ascendant III</option>
                            <option value="8-1">Immortal I</option>
                            <option value="8-2">Immortal II</option>
                            <option value="8-3">Immortal III</option>
                            <option value="9">Radiant</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">ÏÉùÏÑ±ÌïòÍ∏∞</button>
                </form>
            </div>
        </div>

        <div class="modal" id="scrimModal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Ïä§ÌÅ¨Î¶º ÏÉÅÏÑ∏</h2>
                <div id="scrimDetails"></div>
            </div>
        </div>
    </div>

    <script>
const state = {currentUser: null, currentTeam: null, scrims: [], filteredScrims: []};
const RANKS = {'6-1': 'Diamond I', '6-2': 'Diamond II', '6-3': 'Diamond III', '7-1': 'Ascendant I', '7-2': 'Ascendant II', '7-3': 'Ascendant III', '8-1': 'Immortal I', '8-2': 'Immortal II', '8-3': 'Immortal III', 9: 'Radiant'};

document.addEventListener('DOMContentLoaded', () => {
    initializeApp();
    setupEventListeners();
    loadMockData();
});

function initializeApp() {
    // Discord Î°úÍ∑∏Ïù∏ ÏΩúÎ∞± Ï≤òÎ¶¨
    checkDiscordLogin();
    
    // Ï†ÄÏû•Îêú Ïú†Ï†Ä ÏûàÏúºÎ©¥ ÏûêÎèô Î°úÍ∑∏Ïù∏
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
        state.currentUser = JSON.parse(savedUser);
        updateUserUI();
        loadUserTeam();
        return; // Ïù¥ÎØ∏ Î°úÍ∑∏Ïù∏Îê®
    }

    // Ï†ÄÏû•Îêú Ïú†Ï†Ä ÏóÜÍ≥† Discord ÌÜ†ÌÅ∞ ÏûàÏúºÎ©¥ ÏûêÎèô Î°úÍ∑∏Ïù∏ ÏãúÎèÑ
    const savedToken = localStorage.getItem('discordToken');
    if (savedToken) {
        autoLoginWithToken(savedToken);
    }
}

async function autoLoginWithToken(token) {
    try {
        const response = await fetch('https://discord.com/api/users/@me', {
            headers: { Authorization: 'Bearer ' + token }
        });
        
        if (response.ok) {
            const userData = await response.json();
            const user = {
                id: userData.id,
                discordId: userData.id,
                name: userData.username,
                avatar: userData.avatar ? 'https://cdn.discordapp.com/avatars/' + userData.id + '/' + userData.avatar + (userData.avatar.startsWith('a_') ? '.gif' : '.png') : null,
                banner_color: userData.banner_color || null,
                public_flags: userData.public_flags || 0,
                premium_type: userData.premium_type || 0,
                avatar_decoration: userData.avatar_decoration || null,
                teamId: null,
                noShow: 0
            };
            
            // Í∏∞Ï°¥ ÌåÄ Ï†ïÎ≥¥ Ïú†ÏßÄ
            const savedTeam = localStorage.getItem('currentTeam');
            if (savedTeam) user.teamId = JSON.parse(savedTeam).id;
            
            state.currentUser = user;
            localStorage.setItem('currentUser', JSON.stringify(user));
            updateUserUI();
            loadUserTeam();
        } else {
            // ÌÜ†ÌÅ∞ ÎßåÎ£å - ÏÇ≠Ï†ú
            localStorage.removeItem('discordToken');
        }
    } catch (e) {
        localStorage.removeItem('discordToken');
    }
}

function setupEventListeners() {
    document.querySelectorAll('.nav-btn').forEach(btn => {
        btn.addEventListener('click', (e) => switchTab(e.target.dataset.tab));
    });
    document.getElementById('loginBtn')?.addEventListener('click', handleLogin);
    document.getElementById('rankFilter')?.addEventListener('change', filterScrims);
    document.getElementById('refreshBtn')?.addEventListener('click', loadScrims);
    document.getElementById('createScrimForm')?.addEventListener('submit', handleCreateScrim);
    document.getElementById('teamForm')?.addEventListener('submit', handleCreateTeam);
    document.getElementById('createTeamBtn')?.addEventListener('click', () => openModal('teamModal'));
    document.querySelectorAll('.close').forEach(closeBtn => {
        closeBtn.addEventListener('click', (e) => closeModal(e.target.closest('.modal').id));
    });
    window.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal')) closeModal(e.target.id);
    });
}

function switchTab(tabName) {
    document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
    document.getElementById(tabName).classList.add('active');
    if (tabName === 'scrims') loadScrims();
    else if (tabName === 'history') loadHistory();
}

function handleLogin() {
    window.location.href = '/api/auth-login';
}

function checkDiscordLogin() {
    const discordUser = localStorage.getItem('discordUser');
    if (discordUser) {
        const userData = JSON.parse(discordUser);
        const user = {
            id: userData.id,
            discordId: userData.id,
            name: userData.username,
            avatar: userData.avatar ? 'https://cdn.discordapp.com/avatars/' + userData.id + '/' + userData.avatar + (userData.avatar.startsWith('a_') ? '.gif' : '.png') : null,
            banner_color: userData.banner_color || null,
            banner: userData.banner || null,
            public_flags: userData.public_flags || 0,
            premium_type: userData.premium_type || 0,
            avatar_decoration: userData.avatar_decoration || null,
            kov_member: userData.kov_member || false,
            kov_tier: userData.kov_tier || null,
            kov_role_ids: userData.kov_role_ids || [],
            teamId: null,
            noShow: 0
        };
        state.currentUser = user;
        localStorage.setItem('currentUser', JSON.stringify(user));
        localStorage.removeItem('discordUser'); // Ï§ëÎ≥µ Î∞©ÏßÄ
        updateUserUI();
        loadUserTeam();
        // ÌôòÏòÅ Ïï†ÎãàÎ©îÏù¥ÏÖò ÌëúÏãú
        showWelcome(user);
    }
}

function updateUserUI() {
    const userInfo = document.getElementById('userInfo');
    if (state.currentUser) {
        const avatarHtml = state.currentUser.avatar 
            ? '<img src="' + state.currentUser.avatar + '" style="width:32px;height:32px;border-radius:50%;border:2px solid var(--val-red);margin-right:8px;vertical-align:middle;">'
            : '<span style="margin-right:8px;font-size:1.2rem;">üë§</span>';
        userInfo.innerHTML = avatarHtml + '<span class="user-name" style="font-weight:600;">' + state.currentUser.name + '</span>';
        updateSidebar();
    } else {
        userInfo.innerHTML = '<button class="btn btn-primary" id="loginBtn">Discord Î°úÍ∑∏Ïù∏</button>';
        document.getElementById('loginBtn').addEventListener('click', handleLogin);
        hideSidebar();
    }
}

function updateSidebar() {
    if (!state.currentUser) return;
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.add('visible');

    const avatarEl = document.getElementById('profileAvatar');
    const placeholderEl = document.getElementById('profileAvatarPlaceholder');

    // ÏïÑÎ∞îÌÉÄ
    if (state.currentUser.avatar) {
        avatarEl.src = state.currentUser.avatar;
        avatarEl.style.display = 'block';
        placeholderEl.style.display = 'none';
    }

    // Ïù¥Î¶Ñ
    document.getElementById('profileName').textContent = state.currentUser.name;
    document.getElementById('profileTag').textContent = 'Discord Ïó∞Îèô ‚úÖ';

    // ÌåÄ Ï†ïÎ≥¥
    if (state.currentTeam) {
        document.getElementById('profileTeam').innerHTML = 'ÌåÄ: <span>' + state.currentTeam.name + '</span>';
    }

    // Ïä§ÌÉØ
    const myStats = state.scrims.filter(s => s.teamId === state.currentTeam?.id);
    const matchedStats = state.scrims.filter(s => s.status === 'MATCHED' && (s.teamId === state.currentTeam?.id || s.matchedTeam === state.currentTeam?.id));
    document.getElementById('statScrims').textContent = myStats.length;
    document.getElementById('statMatches').textContent = matchedStats.length;
    document.getElementById('statNoShow').textContent = state.currentUser.noShow || 0;

    // Î±ÉÏßÄ & ÎãàÌä∏Î°ú Ï†ÅÏö©
    applyDiscordBadges(state.currentUser);

    // KOV ÏÑúÎ≤Ñ Ïù∏Ï¶ù Ìã∞Ïñ¥ ÌëúÏãú
    loadKovTier();

    // Ï†ÄÏû•Îêú ÎùºÏù¥Ïóá Ìã∞Ïñ¥ Î≥µÏõê (KOV Ìã∞Ïñ¥ ÏóÜÏùÑ ÎïåÎßå)
    if (!state.currentUser?.kov_tier) {
        loadSavedRiotVerify();
    }
}

function loadKovTier() {
    const user = state.currentUser;
    if (!user || !user.kov_tier) return;

    const tierName = user.kov_tier;
    const tierBase = tierName.split(' ')[0];

    // ÎùºÏù¥Ïóá ÏàòÎèô ÏûÖÎ†•Ï∞Ω Ïà®Í∏∞Í≥† KOV Ïù∏Ï¶ù Ìã∞Ïñ¥ ÌëúÏãú
    document.getElementById('riotInputSection').style.display = 'none';
    document.getElementById('riotTierDisplay').style.display = 'block';
    document.getElementById('tierName').textContent = tierName;
    document.getElementById('tierRR').textContent = 'KOV ÏÑúÎ≤Ñ Ïù∏Ï¶ù ‚úÖ';
    document.getElementById('tierIcon').src = TIER_ICONS[tierBase] || TIER_ICONS['Diamond'];

    // Ïù∏Ï¶ù Î≤ÑÌäº Ïà®Í∏∞Í∏∞ (KOV Ïù∏Ï¶ùÏù¥ Ïö∞ÏÑ†)
    const resetBtn = document.querySelector('#tierBadge button');
    if (resetBtn) resetBtn.style.display = 'none';
}





// ===== Í≥†Í∏â ÌïÑÌÑ∞ Ìã∞Ïñ¥ ÎìúÎ°≠Îã§Ïö¥ =====
function toggleAdvTierDropdown() {
    const dropdown = document.getElementById('advTierDropdown');
    
    // Í≥†Í∏â Ìã∞Ïñ¥ ÎìúÎ°≠Îã§Ïö¥ Ïó¥ Îïå Í∏∞Î≥∏ Îû≠ÌÅ¨ ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
    const rankDropdown = document.getElementById('rankDropdown');
    if (rankDropdown) {
        rankDropdown.classList.remove('show');
    }
    
    dropdown.classList.toggle('show');
}

function selectAdvTier(value, text, iconUrl) {
    // hidden input ÏóÖÎç∞Ïù¥Ìä∏
    document.getElementById('advTierFilter').value = value;
    
    // ÎîîÏä§ÌîåÎ†àÏù¥ ÏóÖÎç∞Ïù¥Ìä∏
    const display = document.getElementById('advTierDisplay');
    const displayText = document.getElementById('advTierDisplayText');
    
    // Í∏∞Ï°¥ ÏïÑÏù¥ÏΩò Ï†úÍ±∞
    const existingIcon = display.querySelector('img');
    if (existingIcon) existingIcon.remove();
    
    // ÏÉà ÏïÑÏù¥ÏΩò Ï∂îÍ∞Ä
    if (iconUrl) {
        const icon = document.createElement('img');
        icon.src = iconUrl;
        icon.alt = text;
        display.insertBefore(icon, displayText);
    }
    
    displayText.textContent = text;
    
    // selected ÌÅ¥ÎûòÏä§ ÏóÖÎç∞Ïù¥Ìä∏
    const allOptions = document.querySelectorAll('#advTierDropdown .rank-option');
    allOptions.forEach(opt => opt.classList.remove('selected'));
    const selected = document.querySelector(`#advTierDropdown [data-value="${value}"]`);
    if (selected) selected.classList.add('selected');
    
    // ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
    document.getElementById('advTierDropdown').classList.remove('show');
}

// ÎìúÎ°≠Îã§Ïö¥ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞ (Í≥†Í∏â ÌïÑÌÑ∞Ïö©)
document.addEventListener('click', (e) => {
    const advTierWrapper = document.querySelector('#advTierDisplay')?.parentElement;
    const advDropdown = document.getElementById('advTierDropdown');
    if (advTierWrapper && advDropdown && !advTierWrapper.contains(e.target)) {
        advDropdown.classList.remove('show');
    }
});

// ===== Í≥†Í∏â ÌïÑÌÑ∞ ÏãúÏä§ÌÖú =====
let advancedFilters = {
    search: '',
    tier: '',
    time: '',
    server: '',
    map: '',
    gcOnly: false,
    coachOnly: false
};

function toggleAdvancedFilter() {
    const panel = document.getElementById('advancedFilterPanel');
    const btn = document.getElementById('filterSettingsBtn');
    
    // Í≥†Í∏â ÌïÑÌÑ∞ Ïó¥ Îïå Í∏∞Î≥∏ Îû≠ÌÅ¨ ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
    const rankDropdown = document.getElementById('rankDropdown');
    if (rankDropdown) {
        rankDropdown.classList.remove('show');
    }
    
    panel.classList.toggle('show');
    btn.classList.toggle('active');
}

function applyAllFilters() {
    // Í≤ÄÏÉâÏñ¥
    advancedFilters.search = document.getElementById('searchInput').value.toLowerCase();
    
    // Í≥†Í∏â ÌïÑÌÑ∞
    advancedFilters.tier = document.getElementById('advTierFilter').value;
    advancedFilters.time = document.getElementById('advTimeFilter').value;
    advancedFilters.server = document.getElementById('advServerFilter').value;
    advancedFilters.map = document.getElementById('advMapFilter').value;
    advancedFilters.gcOnly = document.getElementById('advGcFilter').checked;
    advancedFilters.coachOnly = document.getElementById('advCoachFilter').checked;
    
    filterScrims();
}

function resetAdvancedFilters() {
    // Í≤ÄÏÉâÏ∞Ω Ï¥àÍ∏∞Ìôî
    document.getElementById('searchInput').value = '';
    
    // Í≥†Í∏â ÌïÑÌÑ∞ Ï¥àÍ∏∞Ìôî
    document.getElementById('advTierFilter').value = '';
    document.getElementById('advTimeFilter').value = '';
    document.getElementById('advServerFilter').value = '';
    document.getElementById('advMapFilter').value = '';
    document.getElementById('advGcFilter').checked = false;
    document.getElementById('advCoachFilter').checked = false;
    
    // Í≥†Í∏â Ìã∞Ïñ¥ ÎîîÏä§ÌîåÎ†àÏù¥ Ï¥àÍ∏∞Ìôî
    const advTierDisplay = document.getElementById('advTierDisplay');
    const advTierText = document.getElementById('advTierDisplayText');
    const existingIcon = advTierDisplay?.querySelector('img');
    if (existingIcon) existingIcon.remove();
    if (advTierText) advTierText.textContent = 'Ï†ÑÏ≤¥';
    
    // Í∏∞Ï°¥ ÌïÑÌÑ∞ÎèÑ Ï¥àÍ∏∞Ìôî
    document.getElementById('rankFilter').value = '';
    document.getElementById('mapFilter').value = '';
    
    // Îû≠ÌÅ¨ ÌïÑÌÑ∞ ÎîîÏä§ÌîåÎ†àÏù¥ Ï¥àÍ∏∞Ìôî
    const rankDisplay = document.getElementById('rankSelectDisplay');
    const rankText = document.getElementById('rankDisplayText');
    const rankIcon = rankDisplay?.querySelector('img');
    if (rankIcon) rankIcon.remove();
    if (rankText) rankText.textContent = 'Ï†ÑÏ≤¥';
    
    // ÌïÑÌÑ∞ Í∞ùÏ≤¥ Ï¥àÍ∏∞Ìôî
    advancedFilters = {
        search: '',
        tier: '',
        time: '',
        server: '',
        map: '',
        gcOnly: false,
        coachOnly: false
    };
    
    filterScrims();
}

function getTimeCategory(timeStr) {
    if (!timeStr) return '';
    const hour = parseInt(timeStr.split(':')[0]);
    if (hour >= 6 && hour < 12) return 'morning';
    if (hour >= 12 && hour < 18) return 'afternoon';
    if (hour >= 18 && hour < 24) return 'evening';
    return 'night';
}

// ===== Îû≠ÌÅ¨ ÌïÑÌÑ∞ ÎìúÎ°≠Îã§Ïö¥ =====
let selectedRankIcon = null;

function toggleRankDropdown() {
    const dropdown = document.getElementById('rankDropdown');
    
    // Îû≠ÌÅ¨ ÎìúÎ°≠Îã§Ïö¥ Ïó¥ Îïå Í≥†Í∏â ÌïÑÌÑ∞ Îã´Í∏∞
    const advPanel = document.getElementById('advancedFilterPanel');
    const advBtn = document.getElementById('filterSettingsBtn');
    if (advPanel && advPanel.classList.contains('show')) {
        advPanel.classList.remove('show');
        advBtn.classList.remove('active');
    }
    
    // Í≥†Í∏â Ìã∞Ïñ¥ ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
    const advTierDropdown = document.getElementById('advTierDropdown');
    if (advTierDropdown) {
        advTierDropdown.classList.remove('show');
    }
    
    dropdown.classList.toggle('show');
}

function selectRank(value, text, iconUrl) {
    selectedRankIcon = iconUrl;
    
    // hidden input ÏóÖÎç∞Ïù¥Ìä∏
    document.getElementById('rankFilter').value = value;
    
    // ÎîîÏä§ÌîåÎ†àÏù¥ ÏóÖÎç∞Ïù¥Ìä∏
    const display = document.getElementById('rankSelectDisplay');
    const displayText = document.getElementById('rankDisplayText');
    
    // Í∏∞Ï°¥ ÏïÑÏù¥ÏΩò Ï†úÍ±∞
    const existingIcon = display.querySelector('img');
    if (existingIcon) existingIcon.remove();
    
    // ÏÉà ÏïÑÏù¥ÏΩò Ï∂îÍ∞Ä
    if (iconUrl) {
        const icon = document.createElement('img');
        icon.src = iconUrl;
        icon.alt = text;
        display.insertBefore(icon, displayText);
    }
    
    displayText.textContent = text;
    
    // selected ÌÅ¥ÎûòÏä§ ÏóÖÎç∞Ïù¥Ìä∏
    document.querySelectorAll('.rank-option').forEach(opt => opt.classList.remove('selected'));
    const selected = document.querySelector(`[data-value="${value}"]`);
    if (selected) selected.classList.add('selected');
    
    // ÎìúÎ°≠Îã§Ïö¥ Îã´Í∏∞
    document.getElementById('rankDropdown').classList.remove('show');
    
    // ÌïÑÌÑ∞ Ï†ÅÏö©
    filterScrims();
}

// ÎìúÎ°≠Îã§Ïö¥ Ïô∏Î∂Ä ÌÅ¥Î¶≠Ïãú Îã´Í∏∞ (Îû≠ÌÅ¨ ÌïÑÌÑ∞)
document.addEventListener('click', (e) => {
    // Í∏∞Î≥∏ Îû≠ÌÅ¨ ÌïÑÌÑ∞
    const rankWrapper = document.getElementById('rankSelectDisplay')?.parentElement;
    const rankDropdown = document.getElementById('rankDropdown');
    if (rankWrapper && rankDropdown && !rankWrapper.contains(e.target)) {
        rankDropdown.classList.remove('show');
    }
});

// ===== ÎùºÏù¥Ïóá Ìã∞Ïñ¥ Ïù∏Ï¶ù =====
const TIER_ICONS = {
    'Iron':       'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/1.png',
    'Bronze':     'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/4.png',
    'Silver':     'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/7.png',
    'Gold':       'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/10.png',
    'Platinum':   'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/13.png',
    'Diamond':    'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/16.png',
    'Ascendant':  'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/19.png',
    'Immortal':   'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/22.png',
    'Radiant':    'https://trackercdn.com/cdn/tracker.gg/valorant/icons/tiersv2/25.png',
};

async function verifyRiotAccount() {
    const name = document.getElementById('riotName').value.trim();
    const tag = document.getElementById('riotTag').value.trim().replace('#', '');
    const statusEl = document.getElementById('verifyStatus');
    const btn = document.getElementById('verifyBtn');

    if (!name || !tag) {
        statusEl.textContent = 'ÎãâÎÑ§ÏûÑÍ≥º ÌÉúÍ∑∏Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!';
        statusEl.className = 'verify-status error';
        return;
    }

    btn.disabled = true;
    statusEl.textContent = 'üîç Ï°∞Ìöå Ï§ë...';
    statusEl.className = 'verify-status loading';

    try {
        // Netlify FunctionÏùÑ ÌÜµÌï¥ Riot API Ìò∏Ï∂ú (API ÌÇ§ Î≥¥Ïïà)
        const res = await fetch(`/api/verify-riot?name=${encodeURIComponent(name)}&tag=${encodeURIComponent(tag)}`);
        const data = await res.json();

        if (!data.success) {
            throw new Error(data.error || 'Í≥ÑÏ†ïÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏñ¥Ïöî');
        }

        const tierName = data.tier;
        const rr = data.rr;
        const tierBase = tierName.split(' ')[0];

        // Ï†ÄÏû•
        const riotData = {
            name: name,
            tag: tag,
            tier: tierName,
            rr: rr,
            verifiedAt: Date.now()
        };
        localStorage.setItem('riotVerified', JSON.stringify(riotData));

        // ÌòÑÏû¨ Ïú†Ï†ÄÏóêÎèÑ Î∞òÏòÅ
        if (state.currentUser) {
            state.currentUser.riotTier = tierName;
            state.currentUser.riotRR = rr;
            state.currentUser.riotName = name + '#' + tag;
            localStorage.setItem('currentUser', JSON.stringify(state.currentUser));
        }

        showVerifiedTier(tierName, rr, tierBase, name, tag);
        statusEl.textContent = '';

    } catch (e) {
        statusEl.textContent = '‚ùå ' + (e.message || 'Ï°∞Ìöå Ïã§Ìå®. ÎãâÎÑ§ÏûÑ#ÌÉúÍ∑∏ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî');
        statusEl.className = 'verify-status error';
        btn.disabled = false;
    }
}

function showVerifiedTier(tierName, rr, tierBase, name, tag) {
    document.getElementById('riotInputSection').style.display = 'none';
    document.getElementById('riotTierDisplay').style.display = 'block';
    document.getElementById('tierName').textContent = tierName + '  ' + name + '#' + tag;
    document.getElementById('tierRR').textContent = rr + ' RR';
    document.getElementById('tierIcon').src = TIER_ICONS[tierBase] || TIER_ICONS['Iron'];
}

function resetRiotVerify() {
    localStorage.removeItem('riotVerified');
    if (state.currentUser) {
        delete state.currentUser.riotTier;
        delete state.currentUser.riotRR;
        delete state.currentUser.riotName;
        localStorage.setItem('currentUser', JSON.stringify(state.currentUser));
    }
    document.getElementById('riotInputSection').style.display = 'block';
    document.getElementById('riotTierDisplay').style.display = 'none';
    document.getElementById('riotName').value = '';
    document.getElementById('riotTag').value = '';
    document.getElementById('verifyStatus').textContent = '';
    document.getElementById('verifyBtn').disabled = false;
}

function loadSavedRiotVerify() {
    const saved = localStorage.getItem('riotVerified');
    if (!saved) return;
    try {
        const data = JSON.parse(saved);
        const tierBase = data.tier.split(' ')[0];
        showVerifiedTier(data.tier, data.rr, tierBase, data.name, data.tag);
    } catch(e) {
        localStorage.removeItem('riotVerified');
    }
}

function applyDiscordBadges(user) {
    const flags = user.public_flags || 0;
    const premiumType = user.premium_type || 0;
    const badges = [];

    // ÎãàÌä∏Î°ú ÌÉÄÏûÖ ÌôïÏù∏
    if (premiumType === 1) {
        badges.push({ class: 'badge-nitro-classic', icon: 'üíé', label: 'Nitro Classic' });
        applyNitroEffect(user, 'classic');
    } else if (premiumType === 2) {
        badges.push({ class: 'badge-nitro', icon: '‚ú®', label: 'Nitro' });
        applyNitroEffect(user, 'full');
    } else if (premiumType === 3) {
        badges.push({ class: 'badge-nitro', icon: 'üöÄ', label: 'Nitro Basic' });
        applyNitroEffect(user, 'basic');
    }

    // Discord Í≥µÏãù Î±ÉÏßÄ (public_flags ÎπÑÌä∏ÎßàÏä§ÌÅ¨)
    if (flags & 1) badges.push({ class: 'badge-staff', icon: 'üõ°Ô∏è', label: 'Staff' });
    if (flags & 2) badges.push({ class: 'badge-partner', icon: 'ü§ù', label: 'Partner' });
    if (flags & 4) badges.push({ class: 'badge-hypesquad', icon: 'üè†', label: 'HypeSquad' });
    if (flags & 8) badges.push({ class: 'badge-bughunter', icon: 'üêõ', label: 'Bug Hunter' });
    if (flags & 64) badges.push({ class: 'badge-hypesquad', icon: '‚ö°', label: 'Bravery' });
    if (flags & 128) badges.push({ class: 'badge-hypesquad', icon: 'üí°', label: 'Brilliance' });
    if (flags & 256) badges.push({ class: 'badge-hypesquad', icon: 'üíô', label: 'Balance' });
    if (flags & 512) badges.push({ class: 'badge-early', icon: 'üåü', label: 'Early Supporter' });
    if (flags & 16384) badges.push({ class: 'badge-bughunter', icon: 'ü•á', label: 'Bug Hunter Lv2' });
    if (flags & 131072) badges.push({ class: 'badge-early', icon: 'üîÆ', label: 'Early Dev' });
    if (flags & 4194304) badges.push({ class: 'badge-active', icon: 'üéÆ', label: 'Active Dev' });

    // Î±ÉÏßÄ Î†åÎçîÎßÅ
    const badgesEl = document.getElementById('profileBadges');
    if (badges.length > 0) {
        badgesEl.innerHTML = badges.map(b => 
            '<span class="badge ' + b.class + '">' + b.icon + ' ' + b.label + '</span>'
        ).join('');
    } else {
        badgesEl.innerHTML = '<span class="badge badge-active">üéÆ Valorant Player</span>';
    }

    // ÏïÑÎ∞îÌÉÄ Ïû•Ïãù Ï†ÅÏö© (ÏïÑÎ∞îÌÉÄÎßå Íµ¨Îß§Ìïú Ïú†Ï†Ä Ìè¨Ìï®!)
    if (user.avatar_decoration) {
        applyAvatarDecoration(user);
    }
}

function applyNitroEffect(user, type) {
    const avatarEl = document.getElementById('profileAvatar');
    avatarEl.classList.add('avatar-nitro');

    const bannerEl = document.getElementById('profileBanner');
    if (user.banner_color) {
        bannerEl.style.background = user.banner_color;
    } else if (type === 'full') {
        bannerEl.classList.add('nitro-banner');
    } else {
        bannerEl.style.background = 'linear-gradient(135deg, #6366f1, #4f46e5)';
    }

    document.getElementById('welcomeName').style.background = 'linear-gradient(135deg, #8b5cf6, #ec4899)';
    document.getElementById('welcomeName').style.webkitBackgroundClip = 'text';
    document.getElementById('welcomeName').style.webkitTextFillColor = 'transparent';
}

function applyAvatarDecoration(user) {
    // ÏïÑÎ∞îÌÉÄ Ïû•ÏãùÏù¥ ÏûàÎäî Í≤ΩÏö∞ (ÏïÑÎ∞îÌÉÄ Ïû•ÏãùÎßå Íµ¨Îß§Ìïú Ïú†Ï†Ä Ìè¨Ìï®)
    if (!user.avatar_decoration) return;

    const decoration = user.avatar_decoration;
    const avatarEl = document.getElementById('profileAvatar');
    const placeholderEl = document.getElementById('profileAvatarPlaceholder');
    const avatarWrapper = avatarEl.parentElement;

    // Í∏∞Ï°¥ Ïû•Ïãù Ï†úÍ±∞
    const existingDeco = document.getElementById('avatarDecoration');
    if (existingDeco) existingDeco.remove();

    // ÏïÑÎ∞îÌÉÄ wrapper Ïä§ÌÉÄÏùº
    avatarWrapper.style.position = 'relative';
    avatarWrapper.style.display = 'inline-block';

    // Ïû•Ïãù Ïù¥ÎØ∏ÏßÄ ÏÉùÏÑ±
    const decoEl = document.createElement('img');
    decoEl.id = 'avatarDecoration';

    // Discord CDNÏóêÏÑú Ïû•Ïãù Ïù¥ÎØ∏ÏßÄ Í∞ÄÏ†∏Ïò§Í∏∞
    const assetId = typeof decoration === 'object' ? decoration.asset : decoration;
    decoEl.src = 'https://cdn.discordapp.com/avatar-decoration-presets/' + assetId + '.png';
    
    decoEl.style.cssText = `
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 96px;
        height: 96px;
        pointer-events: none;
        z-index: 10;
    `;

    // ÏïÑÎ∞îÌÉÄ wrapperÏóê relative Ìè¨ÏßÄÏÖò ÏÑ§Ï†ï
    const targetEl = avatarEl.style.display !== 'none' ? avatarEl : placeholderEl;
    
    // wrapper div ÏÉùÏÑ±
    let wrapper = document.getElementById('avatarWrapper');
    if (!wrapper) {
        wrapper = document.createElement('div');
        wrapper.id = 'avatarWrapper';
        wrapper.style.cssText = 'position: relative; display: inline-block; width: 80px; height: 80px; margin: 0 auto 12px;';
        targetEl.parentNode.insertBefore(wrapper, targetEl);
        wrapper.appendChild(targetEl);
    }
    wrapper.appendChild(decoEl);

    // ÏïÑÎ∞îÌÉÄ ÌÖåÎëêÎ¶¨ Ìö®Í≥º
    avatarEl.classList.add('avatar-nitro');

    // Ïõ∞Ïª¥ ÏïÑÎ∞îÌÉÄÏóêÎèÑ Ïû•Ïãù Ï†ÅÏö©
    const welcomeAvatar = document.getElementById('welcomeAvatar');
    const welcomePlaceholder = document.getElementById('welcomeAvatarPlaceholder');
    
    // ÌôòÏòÅÏ∞Ω Ïû•Ïãù Ï†ÅÏö©
    const existingWelcomeDeco = document.getElementById('welcomeDecoration');
    if (existingWelcomeDeco) existingWelcomeDeco.remove();

    const welcomeDecoEl = document.createElement('img');
    welcomeDecoEl.id = 'welcomeDecoration';
    welcomeDecoEl.src = 'https://cdn.discordapp.com/avatar-decoration-presets/' + assetId + '.png';

    const welcomeWrapper = document.getElementById('welcomeAvatarWrapper');
    if (welcomeWrapper) {
        welcomeWrapper.appendChild(welcomeDecoEl);
    }

    // Î±ÉÏßÄÏóê Ïû•Ïãù Íµ¨Îß§Ïûê ÌëúÏãú
    const badgesEl = document.getElementById('profileBadges');
    const existingBadges = badgesEl.innerHTML;
    const hasDecorationBadge = existingBadges.includes('Ïû•Ïãù');
    if (!hasDecorationBadge) {
        badgesEl.innerHTML += '<span class="badge badge-boost">üéÄ ÏïÑÎ∞îÌÉÄ Ïû•Ïãù</span>';
    }
}

function hideSidebar() {
    document.getElementById('sidebar').classList.remove('visible');
}

function showWelcome(user) {
    const overlay = document.getElementById('welcomeOverlay');
    document.getElementById('welcomeName').textContent = user.name.toUpperCase();
    
    if (user.avatar) {
        document.getElementById('welcomeAvatar').src = user.avatar;
        document.getElementById('welcomeAvatar').style.display = 'block';
        document.getElementById('welcomeAvatarPlaceholder').style.display = 'none';
    }
    
    overlay.classList.add('show');
    
    // 1.8Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú Îã´Í∏∞
    setTimeout(() => {
        overlay.classList.remove('show');
    }, 1800);
}

function showLogoutConfirm() {
    document.getElementById('logoutConfirm').classList.add('show');
}

function hideLogoutConfirm() {
    document.getElementById('logoutConfirm').classList.remove('show');
}

function handleLogout() {
    state.currentUser = null;
    state.currentTeam = null;
    localStorage.removeItem('currentUser');
    localStorage.removeItem('currentTeam');
    localStorage.removeItem('discordToken');
    localStorage.removeItem('discordUser');
    hideLogoutConfirm();
    updateUserUI();
}

function handleCreateTeam(e) {
    e.preventDefault();
    if (!state.currentUser) {
        alert('Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
        return;
    }
    const teamName = document.getElementById('teamName').value;
    const avgRank = parseInt(document.getElementById('teamRank').value);
    const newTeam = {
        id: 'team_' + Math.random().toString(36).substr(2, 9),
        name: teamName,
        avgRank: avgRank,
        ownerId: state.currentUser.id
    };
    state.currentTeam = newTeam;
    state.currentUser.teamId = newTeam.id;
    localStorage.setItem('currentTeam', JSON.stringify(newTeam));
    localStorage.setItem('currentUser', JSON.stringify(state.currentUser));
    closeModal('teamModal');
    updateTeamUI();
    alert('ÌåÄÏù¥ ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!');
}

function loadUserTeam() {
    const savedTeam = localStorage.getItem('currentTeam');
    if (savedTeam) {
        state.currentTeam = JSON.parse(savedTeam);
        updateTeamUI();
        updateSidebar();
    }
}

function updateTeamUI() {
    const teamInfo = document.getElementById('teamInfo');
    if (state.currentTeam) {
        teamInfo.innerHTML = `
            <div class="team-card">
                <h3>${state.currentTeam.name}</h3>
                <div class="team-stats">
                    <div class="stat">
                        <span class="stat-label">ÌèâÍ∑† Îû≠ÌÅ¨</span>
                        <span class="stat-value">
                            <span class="rank-badge rank-${RANKS[state.currentTeam.avgRank].toLowerCase()}">
                                ${RANKS[state.currentTeam.avgRank]}
                            </span>
                        </span>
                    </div>
                    <div class="stat">
                        <span class="stat-label">No-Show</span>
                        <span class="stat-value">${state.currentUser?.noShow || 0}Ìöå</span>
                    </div>
                </div>
            </div>
        `;
    }
}

function handleCreateScrim(e) {
    e.preventDefault();
    if (!state.currentUser || !state.currentTeam) {
        alert('ÌåÄÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
        return;
    }
    const date = document.getElementById('scrimDate').value;
    const minRank = parseInt(document.getElementById('minRank').value);
    const maxRank = parseInt(document.getElementById('maxRank').value);
    if (minRank > maxRank) {
        alert('ÏµúÏÜå Îû≠ÌÅ¨Í∞Ä ÏµúÎåÄ Îû≠ÌÅ¨Î≥¥Îã§ ÎÜíÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
        return;
    }
    const newScrim = {
        id: 'scrim_' + Math.random().toString(36).substr(2, 9),
        teamId: state.currentTeam.id,
        teamName: state.currentTeam.name,
        teamRank: state.currentTeam.avgRank,
        date: new Date(date),
        minRank: minRank,
        maxRank: maxRank,
        status: 'OPEN',
        matchedTeam: null
    };
    state.scrims.push(newScrim);
    saveMockData();
    alert('Ïä§ÌÅ¨Î¶ºÏù¥ Îì±Î°ùÎêòÏóàÏäµÎãàÎã§!');
    e.target.reset();
    switchTab('scrims');
}

function loadScrims() {
    const scrimList = document.getElementById('scrimList');
    scrimList.innerHTML = '<div class="loading">Ïä§ÌÅ¨Î¶º Î°úÎìú Ï§ë</div>';
    setTimeout(() => filterScrims(), 500);
}

function filterScrims() {
    const rankFilter = document.getElementById('rankFilter').value;
    let filtered = [...state.scrims];
    if (rankFilter) {
        const rank = parseInt(rankFilter);
        filtered = filtered.filter(scrim => scrim.minRank <= rank && scrim.maxRank >= rank);
    }
    if (state.currentTeam) {
        filtered = filtered.filter(scrim => scrim.teamId !== state.currentTeam.id);
    }
    state.filteredScrims = filtered;
    renderScrims();
}

function renderScrims() {
    const scrimList = document.getElementById('scrimList');
    if (state.filteredScrims.length === 0) {
        scrimList.innerHTML = '<div class="loading">Îì±Î°ùÎêú Ïä§ÌÅ¨Î¶ºÏù¥ ÏóÜÏäµÎãàÎã§.</div>';
        return;
    }
    scrimList.innerHTML = state.filteredScrims
        .sort((a, b) => new Date(a.date) - new Date(b.date))
        .map(scrim => createScrimCard(scrim))
        .join('');
    document.querySelectorAll('.scrim-card').forEach(card => {
        card.addEventListener('click', () => showScrimDetails(card.dataset.scrimId));
    });
}

function createScrimCard(scrim) {
    const date = new Date(scrim.date);
    const formattedDate = date.toLocaleDateString('ko-KR', {month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'});
    const statusClass = scrim.status === 'OPEN' ? 'open' : 'matched';
    const cardClass = scrim.status === 'MATCHED' ? 'matched' : '';
    return `
        <div class="scrim-card ${cardClass}" data-scrim-id="${scrim.id}">
            <div class="scrim-header">
                <div class="team-name">${scrim.teamName}</div>
                <div class="status-badge ${statusClass}">${scrim.status}</div>
            </div>
            <div class="scrim-info">
                <div class="info-row">
                    <span class="info-label">üìÖ</span>
                    <span>${formattedDate}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üèÜ ÌåÄ Îû≠ÌÅ¨:</span>
                    <span class="rank-badge rank-${RANKS[scrim.teamRank].toLowerCase()}">${RANKS[scrim.teamRank]}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üìä ÏöîÍµ¨ Îû≠ÌÅ¨:</span>
                    <span>
                        <span class="rank-badge rank-${RANKS[scrim.minRank].toLowerCase()}">${RANKS[scrim.minRank]}</span>
                        ~
                        <span class="rank-badge rank-${RANKS[scrim.maxRank].toLowerCase()}">${RANKS[scrim.maxRank]}</span>
                    </span>
                </div>
            </div>
        </div>
    `;
}

function showScrimDetails(scrimId) {
    const scrim = state.scrims.find(s => s.id === scrimId);
    if (!scrim) return;
    const modal = document.getElementById('scrimModal');
    const details = document.getElementById('scrimDetails');
    const canMatch = state.currentTeam && scrim.status === 'OPEN' && state.currentTeam.avgRank >= scrim.minRank && state.currentTeam.avgRank <= scrim.maxRank;
    const date = new Date(scrim.date);
    const formattedDate = date.toLocaleDateString('ko-KR', {year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit'});
    details.innerHTML = `
        <div class="scrim-details">
            <h3>${scrim.teamName}</h3>
            <div class="info-row" style="margin: 10px 0;">
                <span class="info-label">ÎÇ†Ïßú:</span>
                <span>${formattedDate}</span>
            </div>
            <div class="info-row" style="margin: 10px 0;">
                <span class="info-label">ÌåÄ Îû≠ÌÅ¨:</span>
                <span class="rank-badge rank-${RANKS[scrim.teamRank].toLowerCase()}">${RANKS[scrim.teamRank]}</span>
            </div>
            <div class="info-row" style="margin: 10px 0;">
                <span class="info-label">ÏöîÍµ¨ Îû≠ÌÅ¨:</span>
                <span>${RANKS[scrim.minRank]} ~ ${RANKS[scrim.maxRank]}</span>
            </div>
            <div class="info-row" style="margin: 10px 0;">
                <span class="info-label">ÏÉÅÌÉú:</span>
                <span class="status-badge ${scrim.status === 'OPEN' ? 'open' : 'matched'}">${scrim.status}</span>
            </div>
            ${canMatch ? `<button class="btn btn-success btn-large" onclick="matchScrim('${scrim.id}')">Îß§Ïπ≠ Ïã†Ï≤≠</button>` : ''}
        </div>
    `;
    openModal('scrimModal');
}

function matchScrim(scrimId) {
    if (!state.currentTeam) {
        alert('ÌåÄÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
        return;
    }
    const scrim = state.scrims.find(s => s.id === scrimId);
    if (!scrim || scrim.status !== 'OPEN') {
        alert('Ïù¥ÎØ∏ Îß§Ïπ≠Îêú Ïä§ÌÅ¨Î¶ºÏûÖÎãàÎã§.');
        return;
    }
    scrim.status = 'MATCHED';
    scrim.matchedTeam = state.currentTeam.id;
    saveMockData();
    closeModal('scrimModal');
    alert('Îß§Ïπ≠Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!');
    loadScrims();
}

function loadHistory() {
    const historyList = document.getElementById('historyList');
    const matchedScrims = state.scrims.filter(s => s.status === 'MATCHED' && (s.teamId === state.currentTeam?.id || s.matchedTeam === state.currentTeam?.id));
    if (matchedScrims.length === 0) {
        historyList.innerHTML = '<div class="loading">Îß§Ïπ≠ ÎÇ¥Ïó≠Ïù¥ ÏóÜÏäµÎãàÎã§.</div>';
        return;
    }
    historyList.innerHTML = matchedScrims.map(scrim => {
        const date = new Date(scrim.date).toLocaleDateString('ko-KR');
        return `
            <div class="history-item">
                <div class="history-teams">
                    <span>${state.currentTeam?.name}</span>
                    <span class="vs">VS</span>
                    <span>${scrim.teamName}</span>
                </div>
                <div>${date}</div>
            </div>
        `;
    }).join('');
}

function openModal(modalId) {
    document.getElementById(modalId).classList.add('active');
}

function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
}

function loadMockData() {
    const saved = localStorage.getItem('mockScrims');
    if (saved) {
        state.scrims = JSON.parse(saved);
    } else {
        state.scrims = [
            {id: 'scrim_1', teamId: 'team_mock1', teamName: 'Team Liquid', teamRank: 8, date: new Date(Date.now() + 86400000), minRank: 7, maxRank: 9, status: 'OPEN', matchedTeam: null},
            {id: 'scrim_2', teamId: 'team_mock2', teamName: 'Sentinels', teamRank: 9, date: new Date(Date.now() + 172800000), minRank: 8, maxRank: 9, status: 'OPEN', matchedTeam: null},
            {id: 'scrim_3', teamId: 'team_mock3', teamName: 'OpTic Gaming', teamRank: 6, date: new Date(Date.now() + 259200000), minRank: 5, maxRank: 7, status: 'OPEN', matchedTeam: null}
        ];
    }
    filterScrims();
}

function saveMockData() {
    localStorage.setItem('mockScrims', JSON.stringify(state.scrims));
}
    </script>

    <!-- ÌôòÏòÅ Ïï†ÎãàÎ©îÏù¥ÏÖò -->
    <div class="welcome-overlay" id="welcomeOverlay">
        <div class="welcome-content">
            <div id="welcomeAvatarWrapper">
                <div class="welcome-avatar-placeholder" id="welcomeAvatarPlaceholder">üë§</div>
                <img class="welcome-avatar" id="welcomeAvatar" style="display:none;" src="" alt="">
            </div>
            <div class="welcome-title">ÌôòÏòÅÌï©ÎãàÎã§!</div>
            <div class="welcome-name" id="welcomeName">AGENT</div>
            <div class="welcome-subtitle">Ïä§ÌÅ¨Î¶º Îß§Ïπ≠ÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî üéÆ</div>
            <div class="welcome-bar">
                <div class="welcome-bar-fill"></div>
            </div>
        </div>
    </div>

    <!-- Î°úÍ∑∏ÏïÑÏõÉ ÌôïÏù∏ -->
    <div class="logout-confirm" id="logoutConfirm">
        <div class="logout-box">
            <h3>Î°úÍ∑∏ÏïÑÏõÉ</h3>
            <p>Ï†ïÎßê Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†Ïñ¥Ïöî?</p>
            <div class="logout-btns">
                <button class="btn btn-secondary" onclick="hideLogoutConfirm()">Ï∑®ÏÜå</button>
                <button class="btn btn-primary" onclick="handleLogout()">Î°úÍ∑∏ÏïÑÏõÉ</button>
            </div>
        </div>
    </div>
</body>
</html>
